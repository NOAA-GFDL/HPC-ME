FROM continuumio/miniconda3:25.3.1-1 as builder
RUN apt-get update -y \
 && apt-get install -y csh git which 
RUN conda create -n env \
 && conda install conda-forge::nco=5.1.9 \
 && conda install -n env conda-forge::r=4.2 conda-forge::cdo=2.4.0 \
 && conda init
RUN mkdir -p /apps \
 && cd /apps \
 && git clone https://gitlab.gfdl.noaa.gov/esd/fudge.git  
RUN mkdir -p /home/esd/bin/ \
 && cp /apps/fudge/checkout-fudge /home/esd/bin/
ENV PATH ${PATH}:/home/esd/bin:/apps/fudge/bin
